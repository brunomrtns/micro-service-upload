{"version":3,"sources":["../../src/shared/multer-config.ts"],"sourcesContent":["import { existsSync, mkdirSync } from 'node:fs'\nimport { resolve } from 'node:path'\n\nimport { format } from 'date-fns'\nimport multer from 'multer'\n\nimport { v4 as uuidv4 } from 'uuid'\n\nconst storageConfig = multer.diskStorage({\n  destination: (_req, _file, cb) => {\n    const dir = resolve(__dirname, '..', 'uploads')\n\n    if (!existsSync(dir)) {\n      mkdirSync(dir)\n    }\n\n    cb(null, dir)\n  },\n  filename: (_req, file, cb) => {\n    const datePart = format(new Date(), 'dd-MM-yyyy')\n    const uniqueId = uuidv4()\n    const fileExtension = file.mimetype.split('/')[1]\n\n    cb(null, `${datePart}-${uniqueId}.${fileExtension}`)\n  }\n})\n\nexport const uploadAndProcessImages = multer({ storage: storageConfig }).array('files')\n"],"names":["uploadAndProcessImages","storageConfig","multer","diskStorage","destination","_req","_file","cb","dir","resolve","__dirname","existsSync","mkdirSync","filename","file","datePart","format","Date","uniqueId","uuidv4","fileExtension","mimetype","split","storage","array"],"mappings":";;;;+BA2BaA;;;eAAAA;;;wBA3ByB;0BACd;yBAED;+DACJ;sBAEU;;;;;;AAE7B,MAAMC,gBAAgBC,eAAM,CAACC,WAAW,CAAC;IACvCC,aAAa,CAACC,MAAMC,OAAOC;QACzB,MAAMC,MAAMC,IAAAA,iBAAO,EAACC,WAAW,MAAM;QAErC,IAAI,CAACC,IAAAA,kBAAU,EAACH,MAAM;YACpBI,IAAAA,iBAAS,EAACJ;QACZ;QAEAD,GAAG,MAAMC;IACX;IACAK,UAAU,CAACR,MAAMS,MAAMP;QACrB,MAAMQ,WAAWC,IAAAA,eAAM,EAAC,IAAIC,QAAQ;QACpC,MAAMC,WAAWC,IAAAA,QAAM;QACvB,MAAMC,gBAAgBN,KAAKO,QAAQ,CAACC,KAAK,CAAC,IAAI,CAAC,EAAE;QAEjDf,GAAG,MAAM,CAAC,EAAEQ,SAAS,CAAC,EAAEG,SAAS,CAAC,EAAEE,cAAc,CAAC;IACrD;AACF;AAEO,MAAMpB,yBAAyBE,IAAAA,eAAM,EAAC;IAAEqB,SAAStB;AAAc,GAAGuB,KAAK,CAAC"}